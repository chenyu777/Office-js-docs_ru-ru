
# Проверка подлинности надстройки Outlook с помощью маркеров удостоверения Exchange

Почтовая надстройка может предоставлять клиентам сведения, полученные из любого места в сети: с сервера, на котором размещена надстройка, из внутренней сети организации или из облака. Однако если эти данные защищены, приложению Outlook требуется способ сопоставления учетной записи Exchange с соответствующей информационной службой. Exchange 2013 может включить единый вход для надстройки, предоставляя маркер, который идентифицирует учетную запись электронной почты, создающую запрос. Вы можете связать этот маркер с зарегистрированным пользователем вашей надстройки, чтобы этот пользователь распознавался каждый раз, когда надстройка подключается к вашей службе.

## Маркеры удостоверений


Два наших примера надстроек используют общедоступные данные: одна отображает карту Bing с адресами, содержащимися в сообщении, а другая дает возможность просмотреть видеоролики YouTube по ссылкам в сообщении. Однако надстройка Outlook также может использовать данные без общего доступа. Вы можете использовать сервер, на котором размещена надстройка, чтобы связать ее с данными во внутренней сети или где-либо в облаке.

Вы можете использовать различные методы для идентификации и проверки подлинности пользователей надстроек. Exchange 2013 упрощает проверку подлинности пользователей, предоставляя маркер удостоверения, который идентифицирует определенную учетную запись электронной почты Exchange. Вы можете связать этот маркер в вашей службе с зарегистрированным пользователем, включая возможность единого входа для клиентов, использующих надстройки Outlook. 

Для использования единого входа в надстройке этот код выполняет следующее.


* Вызывает функцию в интерфейсе API надстройки Outlook, которая возвращает маркер удостоверения.
* Отправляет маркер вместе с запросом на сервер.
* Распаковывает ответ сервера, чтобы отобразить сведения от службы.
    
На стороне сервера все несколько сложнее. При получении сервером запроса от надстройки Outlook процесс работает следующим образом.

* Сервер проверяет маркер. Вы можете использовать для службы нашу [управляемую библиотеку проверки маркеров](../../docs/outlook/use-the-token-validation-library.md) или [создать собственную](../../docs/outlook/validate-an-identity-token.md).
* Сервер проверяет уникальный идентификатор из маркера, чтобы проверить, связан ли он с известным удостоверением. Служба должна [реализовывать метод, сопоставляющий идентификатор](../../docs/outlook/authenticate-a-user-with-an-identity-token.md) с известными пользователями этой службы.
* Если этот уникальный идентификатор соответствует идентификатору, ранее сохраненному на сервере с набором учетных данных, то сервер может отправить запрошенные сведения, не требуя от клиента выполнить вход в службу.
* Если уникальный идентификатор неизвестен, сервер отправляет ответ, указывая, что пользователю необходимо предоставить действительные учетные данные.
* Если учетные данные соответствуют известному удостоверению на сервере, можно сопоставить это удостоверение с уникальным идентификатором в маркере, чтобы при следующем получении подобного запроса сервер смог ответить, не требуя дополнительных действий по входу.

 >**Примечание.** Это лишь один из возможных способов использования маркера удостоверения. Как всегда, при работе с удостоверениями и проверкой подлинности необходимо проверять соответствие кода требованиям к безопасности в организации.

Давайте рассмотрим эти аспекты подробнее. В следующих статьях мы будем использовать простую надстройку Outlook, которая отправляет в веб-службу маркер удостоверения и список телефонных номеров, найденных в сообщении. 

- [Подробные сведения о маркере удостоверения Exchange](../outlook/inside-the-identity-token.md)
- [Вызов службы из надстройки Outlook с использованием маркера удостоверения в Exchange](../outlook/call-a-service-by-using-an-identity-token.md)
- [Использование библиотеки проверки маркеров Exchange](../outlvalidate-an-identity-token.md ook/use-the-token-validation-library.md)
- [Проверка маркера удостоверения Exchange](../outlook/validate-an-identity-token.md )
- [Проверка подлинности пользователя с помощью маркера удостоверения для Exchange](../outlook/validate-an-identity-token.md)


## Дополнительные ресурсы



- [Надстройки Outlook](../outlook/outlook-add-ins.md)
    
- [Вызов веб-служб из надстройки Outlook](../outlook/web-services.md)
    


