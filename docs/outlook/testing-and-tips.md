
# Развертывание и установка надстроек Outlook для тестирования


В рамках разработки надстройки Outlook вам, скорее всего, понадобится несколько раз развертывать и устанавливать надстройку для тестирования, что подразумевает выполнение следующих действий.


1. Создание файла манифеста, в котором описывается надстройка.
    
2. Развертывание файлов пользовательского интерфейса надстройки на веб-сервере.
    
3. Установка надстройки в почтовом ящике пользователя.
    
4. Тестирование надстройки с внесением соответствующих изменений в пользовательский интерфейс или файлы манифеста и повторение этапов 2 и 3 для тестирования изменений.
    

## Создание файла манифеста для надстройки

Каждая надстройка описывается XML-манифестом, то есть документом, который предоставляет серверу сведения о почтовой надстройке, сообщает пользователям подробные сведения о надстройке и определяет местоположение HTML-файла пользовательского интерфейса надстройки. Вы можете сохранить манифест в локальной папке или на сервере, если у сервера Exchange, где размещен почтовый ящик, используемый в тестировании, есть доступ к этому месту. Сведения о создании файла манифеста см. в разделе [Манифесты надстроек Outlook](../outlook/manifests/manifests.md). 


## Развертывание надстройки на веб-сервере

Для создания пользовательского интерфейса надстройки вы можете использовать HTML и JavaScript. Полученный исходный файл сохраняется на веб-сервере, доступ к которому может получить сервер Exchange Server, где размещена надстройка. Исходный файл определяется дочерним элементом **SourceLocation** в элементе [DesktopSettings](http://msdn.microsoft.com/en-us/library/da9fd085-b8cc-2be0-d329-2aa1ef5d3f1c%28Office.15%29.aspx), элементе [TabletSettings](http://msdn.microsoft.com/en-us/library/5c89cc7c-7ae0-49c9-fdd5-4c52118228f6%28Office.15%29.aspx) и элементе [PhoneSettings](http://msdn.microsoft.com/en-us/library/13e4eae3-8e8c-fd55-a1c2-3297b485f327%28Office.15%29.aspx), указанном в файле манифеста надстройки.

После исходного развертывания файлов пользовательского интерфейса для надстройки можно обновить ее пользовательский интерфейс и поведение, заменив HTML-файл на веб-сервере на новую версию.


## Установка надстройки


После подготовки файла манифеста надстройки и развертывания ее пользовательского интерфейса на доступном веб-сервере, вы можете установить надстройку для почтового ящика на сервере Exchange Server с помощью полнофункционального клиента Outlook, Outlook Web App и OWA для устройств или удаленного запуска командлетов Windows PowerShell.


### Установка надстройки в полнофункциональном клиенте Outlook

Вы можете установить надстройку, если ваш почтовый ящик находится в Exchange Online, Exchange 2013 или более поздней версии. В Outlook для Windows можно устанавливать надстройки с помощью представления Office Fluent Backstage. Последовательно выберите пункты **Файл** и **Управление надстройками**, чтобы войти в Центр администрирования Exchange. После входа продолжите процесс установки с этапа 4 в следующем разделе.

В Outlook для Mac выберите пункт **Управление надстройками** в правой части панели надстройки, а затем войдите в Центр администрирования Exchange. Перейдите к этапу 4 в следующем разделе.


### Установка надстройки с помощью Outlook Web App или Outlook.com

Чтобы использовать Outlook Web App (OWA) для установки надстройки Outlook, выполните следующие действия:


1. Перейдите к URL-адресу OWA вашей организации или Outlook.com и выполните вход.
    
2. Щелкните значок шестеренки в правом верхнем углу и выберите команду **Управление надстройками**.
    
3. Чтобы добавить новую надстройку, щелкните значок "плюс" (**+**).
    
4. В раскрывающемся списке выберите **Добавить из файла** (если манифест сохранен в локальной папке).
    
5. Перейдите к манифесту и щелкните **Установить**.
    
6. Выберите имя пользователя в правом верхнем углу окна, а затем щелкните **Моя почта**, чтобы открыть почту для тестирования надстройки.
    

>**Примечание.** Если для разработки надстройки не используются следующие средства: 
- клиент разработчика приложений для Office 365;
- средства разработки Napa для Office 365;
- Visual Studio

Если у вас нет по крайней мере роли "My Custom Apps" для Exchange Server, то вы сможете устанавливать надстройки только из Магазина Office. Чтобы проверить надстройку или иметь возможность устанавливать надстройки, указывая URL-адрес или имя файла манифеста, попросите своего администратора Exchange предоставить вам необходимые разрешения.

Чтобы назначить одному пользователю необходимые разрешения, администратор Exchange может выполнить указанный ниже командлет PowerShell. В данном примере wendyri — это псевдоним электронной почты пользователя.

```New-ManagementRoleAssignment -Role "My Custom Apps" -User "wendyri"```

При необходимости администратор может запустить указанный ниже командлет, чтобы назначить нескольким пользователям похожие требуемые разрешения.

```$users = Get-Mailbox *$users | ForEach-Object { New-ManagementRoleAssignment -Role "My Custom Apps" -User $_.Alias}```

Подробнее о [роли My Custom Apps…](http://technet.microsoft.com/en-us/library/aa0321b3-2ec0-4694-875b-7a93d3d99089%28EXCHG.150%29.aspx) 

Если для разработки надстроек вы используете Office 365, Napa или Visual Studio, вам назначается роль администратора организации, позволяющая устанавливать надстройки с помощью файла или URL-адреса в Центре администрирования Exchange, а также с помощью командлетов Powershell.


### Установка надстройки с помощью удаленного сеанса PowerShell

После создания удаленного сеанса Windows PowerShell на сервере Exchange Server можно установить надстройку Outlook с помощью командлета **New-App** и следующей команды PowerShell.


```
New-App -URL:"http://<fully-qualified URL">
```

Полный URL-адрес — это расположение подготовленного файла манифеста надстройки.

Вы можете использовать следующие командлеты PowerShell для управления надстройками для почтовых ящиков.


-  **Get-App**: отображает надстройки, включенные для почтового ящика.
    
-  **Set-App**: включает или отключает надстройку для почтового ящика.
    
-  **Remove-App**: удаляет ранее установленную надстройку с сервера Exchange.
    

## Дополнительные ресурсы



- [Надстройки Outlook](../outlook/outlook-add-ins.md)
    
- [Устранение ошибок, с которыми сталкиваются пользователи при работе с надстройками Office](../testing/testing-and-troubleshooting.md)
    
