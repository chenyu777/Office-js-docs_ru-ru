
# API-интерфейсы Outlook

Чтобы использовать API-интерфейсы в надстройке Outlook, необходимо указать расположение библиотеки Office.js, набор требований, схему и разрешения.

## Библиотека Office.js

Чтобы работать с API надстроек Outlook, необходимо использовать API-интерфейсы JavaScript в Office.js. CDN библиотеки: _https://appsforoffice.microsoft.com/lib/1/hosted/Office.js_. Надстройки, отправляемые в Магазин Office, должны ссылаться на файл Office.js из этой сети CDN. Использовать локальную ссылку невозможно. 

Объявите CDN в теге **head** веб-страницы (HTML-, ASPX- или PHP-файла), где определяется пользовательский интерфейс надстройки, в атрибуте **src** тега **script**:


```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```

При добавлении новых API-интерфейсов не будет меняться URL-адрес Office.js. Мы укажем другую версию в URL-адресе, только если изменится поведение API.

> **Важно!** Разрабатывая надстройку для ведущего приложения Office, ссылайтесь на API JavaScript для Office из раздела `<head>` страницы. Это гарантирует, что API полностью инициализируется раньше всех элементов основного текста. Ведущим приложениям Office необходимо, чтобы надстройки инициализировались в течение 5 секунд после активации. При превышении этого порога объявляется, что надстройка не отвечает, и отображается сообщение об ошибке.  

## Наборы требований

Все API-интерфейсы Outlook приведены в наборе требований почтового ящика. У этого набора есть версии, а каждый новый набор API-интерфейсов относится к набору более поздней версии. Не все клиенты Outlook поддерживают новейший набор API-интерфейсов в момент выпуска, но если для клиента Outlook объявлена поддержка набора требований, то он будет поддерживать все API-интерфейсы в этом наборе. 

Чтобы указать, в каких клиентах Outlook появляется надстройка, задайте минимальную версию набора требований в манифесте. Например, если указать набор требований версии 1.3, надстройка не будет отображаться в клиентах Outlook, не поддерживающих версию 1.3. 

Указание набора требований не означает, что надстройке будут доступны API-интерфейсы только из этой версии. Если в надстройке указан набор требований версии 1.1, но она выполняется в клиенте Outlook, поддерживающем версию 1.3, то надстройка может использовать API-интерфейсы версии 1.3. От набора требований зависит только то, в каких клиентах Outlook отображается надстройка.

Чтобы проверить доступность API-интерфейсов из набора требований, версия которого выше указанной в манифесте, вы можете использовать стандартный код JavaScript:


```js
if (item.somePropertyOrFunction) {
   item.somePropertyOrFunction...  
}
```

> **Примечание.** Эти проверки необязательны в API-интерфейсах, включенных в набор требований версии, указанной в манифесте.

Укажите минимальную версию набора требований, которая поддерживает критически важные API-интерфейсы для соответствующего сценария. Набор требований указывается в элементах **Requirements**, **Sets** и **Set** манифеста. Дополнительные сведения см. в статьях [Манифесты надстроек Outlook](../outlook/manifests/manifests.md) и [Общие сведения о наборах требований к API Outlook](..\..\reference\outlook\tutorial-api-requirement-sets.md).

Элемент **Methods** не применяется к надстройкам Outlook, поэтому объявлять поддержку определенных методов невозможно.


## Разрешения

Для использования необходимых API-интерфейсов надстройке нужны соответствующие разрешения. Разрешения делятся на четыре уровня. Дополнительные сведения см. в статье [Указание разрешений для доступа надстройки Outlook к почтовому ящику пользователя](../outlook/understanding-outlook-add-in-permissions.md).


|**Уровень разрешений**|**Описание**|
|:-----|:-----|
|Restricted|Позволяет использовать сущности, но не регулярные выражения.|
|Чтение элемента|Помимо возможностей уровня _Ограниченный доступ_, поддерживаются:<ul><li>регулярные выражения</li><li>доступ на чтение API надстроек Outlook;</li><li>получение свойств элемента и маркера обратного доступа.</li></ul>|
|Чтение и запись|Помимо возможностей уровня _Чтение элемента_, поддерживаются:<ul><li>полный доступ ко всем элементам API Outlook, кроме метода <b>makeEwsRequestAsync</b>;</li><li>задание свойств элемента.</li></ul>|
|Чтение и запись почтового ящика|Помимо возможностей уровня _Чтение и запись_, поддерживаются:<ul><li>создание, чтение и запись элементов и папок;</li><li>отправка папок;</li><li>вызов метода [makeEwsRequestAsync](../../reference/outlook/Office.context.mailbox.md#makeewsrequestasyncdata-callback-usercontext).</li></ul>|
В целом необходимо указать минимальные разрешения, необходимые надстройке. Они объявляются в элементе **Permissions** манифеста. Дополнительные сведения см. в статье [Манифесты надстроек Outlook](../outlook/manifests/manifests.md). Сведения о вопросах безопасности см. в статье [Конфиденциальность, разрешения и безопасность для надстроек Outlook](../outlook/../../docs/develop/privacy-and-security.md).


## Дополнительные ресурсы

- [Манифесты надстроек Outlook](../outlook/manifests/manifests.md)

- [Общие сведения о наборах требований API Outlook](../../reference/outlook/tutorial-api-requirement-sets.md)
    
- [Конфиденциальность, разрешения и безопасность для надстроек Outlook](../outlook/../../docs/develop/privacy-and-security.md)
    
