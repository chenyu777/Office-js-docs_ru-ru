# Отладка манифеста надстройки Office с помощью ведения журнала в среде выполнения

Вы можете использовать ведение журнала в среде выполнения для отладки манифеста надстройки Эта функция может помочь вам определять и устранять проблемы с манифестом, которые не обнаруживаются при проверке схемы XSD, например несоответствие идентификаторов ресурсов. Ведение журнала в среде выполнения особенно полезно для отладки надстроек, в которых реализованы команды.  

>**Примечание.** В настоящее время функция ведения журнала в среде выполнения доступна для Office 2016 для настольных систем.

## Включение ведения журнала в среде выполнения

>**Важно!** Ведение журнала в среде выполнения сказывается на производительности. Включайте его, только если требуется устранить неполадки, связанные с манифестом надстройки.

1. Убедитесь, что у вас установлен Office 2016 для настольных систем сборки **16.0.7019** или выше. 
2. Добавьте раздел реестра `RuntimeLogging` в раздел HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Wef\Developer\'. 
3. В качестве значения по умолчанию задайте полный путь к файлу, в который будет записываться журнал. Пример приведен в архиве [EnableRuntimeLogging.zip](RuntimeLogging/EnableRuntimeLogging.zip). 

 > **Примечание.** Необходим готовый каталог, в котором будет создан файл журнала, и соответствующее разрешение на запись. 
 
На приведенном ниже изображении показано, как должен выглядеть реестр.
![Снимок экрана редактора реестра с разделом RuntimeLogging](http://i.imgur.com/Sa9TyI6.png)

Чтобы отключить эту функцию, удалите из реестра раздел `RuntimeLogging`. 

## Устранение неполадок, связанных с манифестом

Чтобы использовать ведение журнала в среде выполнения для устранения неполадок при загрузке надстройки, сделайте следующее:
 
1. [Загрузите неопубликованную надстройку](../testing/sideload-office-add-ins-for-testing.md) для тестирования. 

    >Примечание. Рекомендуем загружать только тестируемую надстройку, чтобы свести к минимуму количество сообщений в файле журнала.
2. Если ничего не происходит и надстройка не отображается в соответствующем диалоговом окне, откройте файл журнала.
3. Выполните в этом файле поиск по идентификатору надстройки, определенному в манифесте. В файле журнала этот идентификатор отмечен как `SolutionId`. 

В приведенном ниже примере файл журнала определяет элемент управления, указывающий на несуществующий файл ресурсов. В этом примере необходимо исправить опечатку в манифесте или добавить недостающий ресурс.

![Снимок экрана с файлом журнала, содержащим запись, которая указывает на несуществующий идентификатор ресурса.](http://i.imgur.com/f8bouLA.png) 

##Известные проблемы с ведением журнала в среде выполнения
В файле журнала могут встречаться непонятные или неправильно классифицированные сообщения. Например:

- сообщение `Medium   Current host not in add-in's host list` с дополнением `Unexpected Parsed manifest targeting different host` неправильно классифицируется как ошибка.
- Если появится сообщение `Unexpected    Add-in is missing required manifest fields  DisplayName`, не содержащее SolutionId, то ошибка, скорее всего, не связана с надстройкой, отладка которой выполняется. 
- Все сообщения `Monitorable` являются ожидаемыми ошибками с точки зрения системы. Иногда они указывают на проблему с манифестом, например опечатку в элементе, которая была пропущена, но не привела к сбою. 

##Дополнительные ресурсы

- [Загрузка неопубликованных надстроек Office для тестирования](../testing/sideload-office-add-ins-for-testing.md)
- [Отладка надстроек Office](../testing/debug-add-ins-using-f12-developer-tools-on-windows-10.md)
