
# Элемент Rule
Указывает правила активации, которые должны оцениваться для этой почтовой надстройки.

 **Тип надстройки:** почтовые.


## Синтаксис:

 **Rule типа ItemIs** задает правило, которое оценивается как истинное, если выбранный элемент имеет указанный тип.


```XML
<Rule xsi:type="ItemIs" 
   ItemType= ["Appointment" | "Message"]
   FormType=["Read" | "Edit" | "ReadOrEdit"] 
   ItemClass = "string " 
   IncludeSubClasses=["true" | "false"] />
```

 **Rule типа ItemHasAttachment** задает правило, которое оценивается как истинное, если элемент содержит вложение.




```XML
<Rule xsi:type="ItemHasAttachment"  />
```

 **ItemHasKnownEntity** задает правило, которое оценивается как истинное, если тема или текст элемента содержит текст указанного типа объекта.




```XML
<Rule xsi:type="ItemHasKnownEntity" 
  EntityType=["MeetingSuggestion" | "TaskSuggestion" |"Address" | "Url" | "PhoneNumber" | "EmailAddress" | "Contact" ]
  RegExFilter="string "
  FilterName="string "
  IgnoreCase=["true | false"]/>
```

 **Rule типа ItemHasRegularExpressionMatch** задает правило, которое оценивается как истинное, если в указанном свойстве элемента обнаруживается соответствие для указанного регулярного выражения.




```XML
<Rule xsi:type="ItemHasRegularExpressionMatch" 
    RegExName="string " 
    RegExValue="string " 
    PropertyName=["Subject" | "BodyAsPlaintext" | "BodyAsHtml" | "SenderSTMPAddress"]
    IgnoreCase=["true" | "false"]
/>
```

 **Rule типа RuleCollection** задает коллекцию правил и логический оператор, который должен использоваться при их оценке.




```XML
<Rule xsi:type="RuleCollection" Mode=["And" | "Or"]>
   ...
</Rule>
```


## Элемент, в котором содержится:

 _[элемент OfficeApp](../../reference/manifest/officeapp.md)_


## Атрибуты:

 **Атрибуты правила ItemIs**



|**Атрибут**|**Тип**|**Обязательный**|**Описание**|
|:-----|:-----|:-----|:-----|
|ItemType|ItemType (string)|обязательно|Задает сопоставляемый тип элемента. Допустимые значения:

|**ItemType**|**Соответствующий элемент ItemClass**|
|:-----|:-----|
|Appointment|IPM.Appointment|
|Message(1)|Включает сообщения электронной почты, приглашения на собрания, ответы и отмены.|
|
|FormType|ItemFormType (string)|обязательно|Определяет, должно ли отображаться приложение в форме чтения или редактирования элемента. Допустимые значения:|

|**FormType**|**Описание**|
|:-----|:-----|
|Чтение|Почтовая надстройка активируется только в формах чтения (для элементов указанного типа **ItemType**).|
|Edit|Почтовая надстройка активируется только в формах создания (для элементов указанного типа **ItemType**).|
|ReadOrEdit|Почтовая надстройка активируется как в формах чтения, так и в формах создания (для элементов указанного типа **ItemType**).|
|ItemClass|string|необязательный|Указывает сопоставляемый специализированный класс сообщений. Дополнительные сведения см. в статье [Активация почтовой надстройки в Outlook для определенного класса сообщений](http://msdn.microsoft.com/library/f464a152-2dff-4fb3-bf98-c1a3639c3e80%28Office.15%29.aspx).|
|IncludeSubClasses|boolean|Необязательный|Указывает, должно ли правило оцениваться как истинное (true), если элемент принадлежит к подклассу указанного класса сообщений; по умолчанию в этом случае правило оценивается как ложное (false).|


(1) Соответствующие классы сообщений: IPM.NoteIPM.Schedule.Meeting.RequestIPM.Schedule.Meeting.NegIPM.Schedule.Meeting.PosIPM.Schedule.Meeting.TentIPM.Schedule.Meeting.Canceled

 **Атрибуты правила ItemHasAttachment**

Нет.

 **Атрибуты правила ItemHasKnownEntity**



|**Атрибут**|**Тип**|**Обязательный**|**Описание**|
|:-----|:-----|:-----|:-----|
|EntityType|KnownEntityType (string)|Обязательный|Задает тип сущности, который должен обнаруживаться, чтобы правило было оценено как истинное. Допустимые значения:

|**KnownEntityType**|**Описание**|
|:-----|:-----|
|MeetingSuggestion|Текст, который идентифицируется средством распознавания шаблонов при поиске события или собрания.|
|TaskSuggestion| Текст, который идентифицируется средством распознавания шаблонов при поиске наличия предусматривающей действие фразы.|
|Address|Текст, который идентифицируется средством распознавания шаблонов при поиске почтового адреса в США.|
|Url|Текст, который идентифицируется средством распознавания шаблонов при поиске наличия имени файла или URL-адреса.|
|PhoneNumber| Ряд цифр, который идентифицируется средством распознавания шаблонов как телефонный номер в Серверной Америке.|
|EmailAddress|Текст, который идентифицируется средством распознавания шаблонов при поиске наличия адреса электронной почты в формате SMTP.|
|Contact|Текст, который идентифицируется средством распознавания шаблонов при поиске наличия контактных сведений.|
|RegExFilter|string|Необязательный|Задает регулярное выражение, которое должно выполняться в этой сущности для активации.|
|FilterName|string|Необязательный|Задает имя фильтра регулярных выражений, чтобы на этот фильтр можно было ссылаться в коде надстройки.|
|IgnoreCase|boolean|Необязательный|Указывает, следует ли игнорировать регистр при оценке регулярного выражения, заданного атрибутом **RegExFilter**.|
 **Атрибуты правила ItemHasRegularExpressionMatch**



|**Атрибут**|**Тип**|**Обязательный**|**Описание**|
|:-----|:-----|:-----|:-----|
|RegExName|string|Обязательный|Указывает имя регулярного выражения, чтобы на него можно было ссылаться в коде надстройки.|
|RegExValue|string|Обязательный|Указывает регулярное выражение, которое будет рассчитано, чтобы определить, требуется ли отображать надстройку. |
|PropertyName|PropertyName (string)|обязательно|Указывает имя свойства, которое будет использоваться для вычисления регулярного выражения. Допустимые значения:

|**PropertyName**|**Описание**|
|:-----|:-----|
|Тема|Применяет регулярное выражение к теме элемента.|
|BodyAsPlaintext|Применяет регулярное выражение к основному тексту элемента в виде обычного текста.|
|BodyAsHtml|Применяет регулярное выражение к основному тексту элемента в формате HTML.|
|SenderSTMPAddress|Применяет регулярное выражение к SMTP-адресу отправителя элемента.|
|IgnoreCase|boolean|Необязательный|Указывает, следует ли игнорировать регистр при выполнении регулярного выражения.|
 **Атрибуты правила RuleCollection**



|**Атрибут**|**Тип**|**Обязательный**|**Описание**|
|:-----|:-----|:-----|:-----|
|Режим|string|обязательно|Указывает логический оператор, используемый при оценке коллекции правил. Допустимые значения: And или Or.|

## Дополнительные ресурсы



- [Активация почтовой надстройки в Outlook для определенного класса сообщений](http://msdn.microsoft.com/library/f464a152-2dff-4fb3-bf98-c1a3639c3e80%28Office.15%29.aspx) и [Правила активации для надстроек Outlook](../../docs/outlook/manifests/activation-rules.md#activation-rules-for-outlook-add-ins)
    
- [Сопоставление строк в элементе Outlook как известных сущностей](../../docs/outlook/match-strings-in-an-item-as-well-known-entities.md)
    
- [Использование регулярных правил активации выражений для отображения надстройки Outlook](../../docs/outlook/use-regular-expressions-to-show-an-outlook-add-in.md)
    
