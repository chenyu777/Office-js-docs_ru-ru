 

# Общие сведения о наборах требований API

Для надстроек Outlook требуются определенные версии API, которые указываются в элементе [Requirements](https://msdn.microsoft.com/EN-US/library/office/dn592036.aspx) в их [манифесте](https://msdn.microsoft.com/en-us/library/office/fp123693.aspx). Надстройки Outlook всегда включают элемент [Set](https://msdn.microsoft.com/EN-US/library/office/dn592049.aspx) с атрибутом `Name`, для которого задано значение `Mailbox`, и атрибутом `MinVersion`, для которого установлен минимальный набор требований API, поддерживающий сценарии надстройки.

Например, в следующем фрагменте манифеста указан минимальный набор требований 1.1:

```
<Requirements>
  <Sets>
    <Set Name="MailBox" MinVersion="1.1" />
  </Sets>
</Requirements>
```

Все API-интерфейсы Outlook приведены в `Mailbox`[наборе требований](https://msdn.microsoft.com/EN-US/library/office/dn535871.aspx#SpecifyRequirementSets_intro). У набора требований `Mailbox` есть версии, а каждый новый выпускаемый набор API-интерфейсов приведен в наборе более поздней версии. Не все клиенты Outlook поддерживают новейший набор API-интерфейсов, но если для клиента Outlook объявлена поддержка набора требований, то он будет поддерживать все API-интерфейсы в этом наборе.

Задайте версию минимального набора требований в манифесте, чтобы указать клиент Outlook, в котором появится надстройка. Если клиент не поддерживает минимальный набор требований, он не загружает надстройку. Например, если указана версия набора требований 1.3, надстройка не отобразится в каком-либо клиенте Outlook, который не поддерживает версии 1.3. и ниже

## Использование API из наборов требования более поздних версий

Установка набора требований не ограничивает доступные API, которые может использовать надстройка. Например, если для надстройки указан набор требований 1.1, но она выполняется в клиенте Outlook, который поддерживает версию 1.3, надстройка может использовать API из набора требований 1.3.\.

Чтобы использовать более новые API, разработчики могут просто проверить их наличие с помощью стандартных методов JavaScript.

```
if (item.somePropertyOrFunction !== undefined) {
  item.somePropertyOrFunction ...
}
```

Такие проверки не нужно выполнять для API-интерфейсов, присутствующих в версии набора требований, указанной в манифесте.

## Выбор минимального набора требований

Разработчикам следует использовать набор требований самой ранней версии, содержащий набор критически важных API для сценария их работы, без которого надстройка не будет работать.

## Клиенты

Указанные ниже клиенты поддерживают надстройки Outlook.

| Клиент | Поддерживаемые наборы требований API |
| --- | --- |
| Outlook 2016 | 1.1, 1.2, 1.3 |
| Outlook 2016 для Mac | 1.1 |
| Outlook 2013 | 1.1, 1.2, 1.3 |
| Outlook в Интернете (Office 365 и Outlook.com) | 1.1, 1.2, 1.3 |
| Outlook Web App (локальная версия Exchange 2013) | 1.1 |
| Outlook Web App (локальная версия Exchange 2016) | 1.1, 1.2. 1.3 |
>**Примечание.** Поддержка версии 1.3 в Outlook 2013 добавлена в рамках [обновления для Outlook 2013 (KB3114349) от 8 декабря 2015 г.](https://support.microsoft.com/en-us/kb/3114349)
